Soybean Marathon Match 2

I. Description of the approach
   1)The main idea of my approach is to decompose the relation yield(variety, location) into a multiplication yield(location) * yield_relative(variety). The yield(location) is taken as the average yield of all variety in that location and the relative yield of variety is taken as the average relative yield compared to other varieties in every location. After calcuating these value, the resulted average is taken back to normalize the yield in each location by each variety and iterates serveral times.
   2)As there are many missing values, the process is degenerated by 4 steps.
       a)If the (loccd, year, variety) triple is known, the result is taken as the mean yield of these experiments.
       b)If there exists (loccd, year) pairs, the result is taken as yield(loccd, year) * relative_yield(variety).
       c)If there exists (loccd, drought) pairs, the result is taken as yield(loccd, drought) * relative_yield(variety).
       d)If there exists (climate_division, year) pairs, the result is taken as yield(climate_division, year) * relative_yield(variety).
       e)Last, as there are very few informations, the average yield of the variety is taken as the result.
   3)The drought information is taken by considered the TMP, PDHI of the corresponding climate_division, state_code and year month. Both TMP and PHDI are divided into 3 part and hence the drought is divided into 9 parts. This is used as a very rought estimate for the climate of that location in the year.
   4)In step 2), for one query there may exist serveral estimate yield by different kind of pairs. We consider the results are A and B. Then the weighted mean is taken as (A * SZ(A) * a + B) / (SZ(A) + 1). A is the more accurate estimatation. SZ(A) is the number of that pairs. More pairs means more confidence. Parameter a is tune by hand and serveral experiments.

II. The meaning of all parameters.
   1)I found out take the yield to be pow(yield, 2) can improve the scroe by about 1000. This is inspected by experiments and I actually don't know the reason.
   2)In function get_estimate_complex, the parameters are generated by linear regression to tune the combination of different estimation. But this code are not used in the final solution and is replaced by the method in I4.